---
// é¡µé¢æ ‡é¢˜ï¼š[slug].astro
import { getCollection, type CollectionEntry } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import Main from "../../components/Main.astro";
import H1 from "../../components/H1.astro";
import TableOfContent from "../../components/TableOfContent.astro";
import Share from "../../components/Share.astro";

// ğŸ§© 1ï¸âƒ£ ç”Ÿæˆæ‰€æœ‰æ–‡ç« çš„é™æ€è·¯å¾„
export async function getStaticPaths() {
  const posts = await getCollection("posts");

  // è¿”å›æ¯ä¸ªæ–‡ç« çš„è·¯ç”±ä¿¡æ¯
  return posts.map((post) => ({
    params: { slug: post.slug }, // URL å‚æ•°ï¼Œæ¯”å¦‚ /posts/first-post
    props: { post }, // æŠŠå½“å‰æ–‡ç« ä¼ é€’ç»™é¡µé¢
  }));
}
// ğŸ§© 2ï¸âƒ£ å®šä¹‰ Props ç±»å‹ï¼ˆå¯é€‰ï¼Œä½†å»ºè®®åŠ ï¼‰
type Props = {
  post: CollectionEntry<"posts">;
};

// ğŸ§© 3ï¸âƒ£ ä» Astro.props ä¸­å–å‡ºå•ç¯‡æ–‡ç« å†…å®¹
const { post } = Astro.props;
const { Content, headings } = await post.render();
// console.log(headings);
---

<!-- ğŸ§© 4ï¸âƒ£ é¡µé¢å†…å®¹å¼€å§‹ -->
<Layout title={post.data.title}>
  <Main>
    <a href="/blog" class="text-blue-600 font-bold mb-5 underline block w-full"
      >&larr; è¿”å›åšå®¢åˆ—è¡¨</a
    >
    <H1 title={post.data.title} />
    <img
      src={post.data.image.replace(/^\.\//, "/")}
      alt={post.data.title}
      class="rounded-2xl shadow-xl mb-28 aspect-thumbnail object-cover"
      width={1024}
      height={1024 / 2}
    />
    <div class="mb-12">
      <TableOfContent headings={headings} />
    </div>

    <div class="relative">
      <Share />
      <div
        class="prose prose-2xl prose-headings:text-red-400 prose-p:text-gray-200 text-white"
      >
        <Content />
      </div>
    </div>
  </Main>
</Layout>
